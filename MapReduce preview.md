# MapReduce preview

## MapReduce 定义

MapReduce 是一个分布式运算程序的编程框架，是用户开发基于 hadoop 的数据分析 应用”的核心框架。

MapReduce 是Hadoop的四个组件之一，是分布式计算系统。

其他三个组件分别是：HDFS分布式存储系统；YARN 资源调度系统；Common 其他三大组件的底层支撑组件，主要提供基础工具包和RPC框架等



## MapReduce 工作过程

MapReduce 的工作流程大致可以分为5步

**分片、格式化——>	执行	MapTask	——>	执行	Shuffle——>	执行	Reduce Task——>	写入文件**

**分片、格式化数据源**：输入 Map 阶段的数据源，必须经过分片和格式化操作。

**执行 MapTask**：每个 Map 任务都有一个内存缓冲区(缓冲区大小 100MB )，输入的分片( split )数据经过 Map 任务处理后的中间结果会写入内存缓冲区中。

**执行 Shuffle 过程**：MapReduce 工作过程中， Map 阶段处理的数据如何传递给 Reduce 阶段，这是 MapReduce 框架中关键的一个过程，这个过程叫作 Shuffle 

**执行 ReduceTask**：输入 ReduceTask 的数据流是<key, {value list}>形式，用户可以自定义 reduce()方法进行逻辑处理，最终以<key, value>的形式输出。

**写入文件**：MapReduce 框架会自动把 ReduceTask 生成的<key, value>传入 OutputFormat 的 write 方法，实现文件的写入操作。



## MapReduce 优点

### 1、MapReduce 易于编程

它简单的实现一些接口，就可以完成一个分布式程序，这个分布式程序可以分布到大量廉价的机器上运行。也就是说你写一个分布式程序，跟写一个简单的串行程序是一模一样的。就是因为这个特点使得MapReduce编程变得非常流行。

### 2、良好的扩展性

当你的计算资源不能得到满足的时候，你可以通过简单的增加机器来扩展它的计算能力。

### 3、高容错性

MapReduce设计的初衷就是使程序能够部署在廉价的机器上，这就要求它具有很高的容错性。比如其中一台机器挂了，它可以把上面的计算任务转移到另外一个节点上运行，不至于这个任务运行失败，而且这个过程不需要人工参与，而完全是由Hadoop内部完成的。

### 4、适合PB级以上海量数据的离线处理

可以实现上千台服务器集群并发工作，提供数据处理能力。


## MapReduce 缺点

### 1、不擅长实时计算

MapReduce无法像MySQL一样，在毫秒或者秒级内返回结果。

### 2、不擅长流式计算

流式计算的输入数据是动态的，而MapReduce的输入数据集是静态的，不能动态变化。这是因为MapReduce自身的设计特点决定了数据源必须是静态的。

### 3、不擅长DAG（有向图）计算

多个应用程序存在依赖关系，后一个应用程序的输入为前一个的输出。在这种情况下，MapReduce并不是不能做，而是使用后，每个MapReduce作业的输出结果都会写入到磁盘，会造成大量的磁盘IO，导致性能非常的低下。



## MapReduce核心思想

1、分布式的运算程序往往需要分成至少2个阶段。
2、第一个阶段的MapTask并发实例，完全并行运行，互不相干。
3、第二个阶段的ReduceTask并发实例互不相干，但是他们的数据依赖于上一个阶段的所有MapTask并发实例的输出。
4、MapReduce编程模型只能包含一个Map阶段和一个Reduce阶段，如果用户的业务逻辑非常复杂，那就只能多个MapReduce程序，串行运行。